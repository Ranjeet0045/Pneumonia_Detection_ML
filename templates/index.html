<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MediScan AI | Advanced Diagnostics</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #26D0CE;
            --secondary: #1A2980;
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --text: #ffffff;
            --danger: #FF6B6B;
            --success: #4ADE80;
        }

        body {
            margin: 0;
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            min-height: 100vh;
            color: var(--text);
            overflow-x: hidden;
        }

        /* --- LAYOUT GRID --- */
        .main-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px;
            align-items: center;
            min-height: 90vh;
        }

        /* --- GLASSMOPHISM CARD (Left Side) --- */
        .glass-card {
            background: var(--glass);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border);
            border-radius: 25px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        /* --- INFO SECTION (Right Side) --- */
        .info-section {
            padding: 20px;
            animation: fadeIn 1s ease-out;
        }

        .info-title {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 20px;
            background: linear-gradient(to right, #26D0CE, #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .info-text {
            font-size: 1em;
            line-height: 1.6;
            opacity: 0.9;
            margin-bottom: 20px;
            background: rgba(0,0,0,0.2);
            padding: 20px;
            border-radius: 15px;
            border-left: 4px solid var(--primary);
        }

        .health-tips {
            margin-top: 30px;
        }

        .tip-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 10px;
            transition: 0.3s;
        }
        .tip-item:hover { background: rgba(255,255,255,0.1); transform: translateX(5px); }
        .tip-icon { font-size: 1.5em; margin-right: 15px; }

        /* --- UPLOAD STYLES --- */
        .badge {
            background: rgba(255, 255, 255, 0.1);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.7em;
            letter-spacing: 1px;
            text-transform: uppercase;
            border: 1px solid rgba(255,255,255,0.2);
            display: inline-block; /* Ensures it doesn't overlap */
            margin-bottom: 15px;
        }

        .upload-area {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            padding: 40px 20px;
            margin-top: 30px;
            cursor: pointer;
            transition: 0.3s;
            position: relative;
        }
        .upload-area:hover { background: rgba(255,255,255,0.05); border-color: var(--primary); }
        
        .upload-icon { font-size: 3em; display: block; margin-bottom: 10px; opacity: 0.8; }
        
        input[type="file"] {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            opacity: 0; cursor: pointer;
        }

        /* --- RESULTS STYLES --- */
        .preview-img {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 15px;
            border: 3px solid rgba(255,255,255,0.2);
            margin: 20px auto;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .status { font-size: 2em; font-weight: 700; margin: 10px 0; text-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .PNEUMONIA { color: var(--danger); }
        .NORMAL { color: var(--success); }

        .progress-container {
            width: 100%;
            background: rgba(0,0,0,0.3);
            height: 10px;
            border-radius: 10px;
            margin-top: 5px;
            overflow: hidden;
        }
        .progress-bar { height: 100%; transition: width 1.5s ease; }
        .bar-danger { background: linear-gradient(90deg, #FF6B6B, #FF8E53); }
        .bar-success { background: linear-gradient(90deg, #4ADE80, #26D0CE); }

        .restart-btn {
            display: inline-block;
            margin-top: 25px;
            padding: 10px 30px;
            background: rgba(255,255,255,0.1);
            color: white;
            text-decoration: none;
            border-radius: 30px;
            border: 1px solid rgba(255,255,255,0.2);
            transition: 0.3s;
        }
        .restart-btn:hover { background: var(--primary); border-color: var(--primary); color: #000; }

        .loader {
            display: none;
            border: 4px solid rgba(255,255,255,0.1);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 40px; height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .main-container { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div class="main-container">
        
        <div class="glass-card">
            <div>
                <span class="badge">MediScan AI v2.0</span>
                <h2 style="margin: 10px 0 5px;">Chest X-Ray Analysis</h2>
            </div>

            {% if not prediction %}
            <p style="opacity: 0.7; font-size: 0.9em;">Upload a PA view chest X-ray for instant deep learning analysis.</p>
            
            <form id="uploadForm" method="post" enctype="multipart/form-data">
                <div class="upload-area" id="dropZone">
                    <span class="upload-icon">üì§</span>
                    <p><strong>Click to Upload</strong><br>or Drag & Drop File</p>
                    <input type="file" name="file" accept="image/*" onchange="showLoader()">
                </div>
            </form>
            <div class="loader" id="loader"></div>

            {% else %}
            <img src="{{ img_path }}" class="preview-img">
            <p style="margin:0; opacity:0.7; font-size:0.8em; letter-spacing: 1px;">ANALYSIS RESULT</p>
            <div class="status {{ prediction }}">{{ prediction }}</div>
            
            <div style="text-align: left; margin-top: 20px; padding: 0 10px;">
                <div style="display:flex; justify-content:space-between; font-size:0.9em; font-weight:600;">
                    <span>AI Confidence</span>
                    <span>{{ confidence }}%</span>
                </div>
                <div class="progress-container">
                    <div class="progress-bar {% if prediction == 'PNEUMONIA' %}bar-danger{% else %}bar-success{% endif %}" 
                         style="width: {{ confidence }}%;"></div>
                </div>
            </div>

            <a href="/" class="restart-btn">Analyze New Scan</a>
            {% endif %}
        </div>


        <div class="info-section">
            
            {% if not prediction %}
            <h1 class="info-title">Understanding Pneumonia</h1>
            <div class="info-text">
                Pneumonia is an infection that inflames the air sacs in one or both lungs. The air sacs may fill with fluid or pus, causing cough with phlegm, fever, chills, and difficulty breathing.
            </div>
            
            <h3 style="margin-top: 30px;">Why Early Detection Matters?</h3>
            <div class="health-tips">
                <div class="tip-item">
                    <span class="tip-icon">‚è±Ô∏è</span>
                    <div><strong>Faster Recovery:</strong> Early diagnosis leads to prompt treatment, reducing the severity of symptoms.</div>
                </div>
                <div class="tip-item">
                    <span class="tip-icon">üõ°Ô∏è</span>
                    <div><strong>Prevent Complications:</strong> Helps avoid severe lung damage, especially in children and the elderly.</div>
                </div>
                <div class="tip-item">
                    <span class="tip-icon">üìâ</span>
                    <div><strong>Stop the Spread:</strong> Identifying viral pneumonia early helps prevent transmission to others.</div>
                </div>
            </div>

            {% elif prediction == 'PNEUMONIA' %}
            <h1 class="info-title" style="color: var(--danger)">‚ö†Ô∏è Action Required</h1>
            <div class="info-text" style="border-color: var(--danger);">
                Our AI has detected signs consistent with Pneumonia. Please consult a medical professional immediately for a confirmed diagnosis and treatment plan.
            </div>

            <h3 style="margin-top: 30px;">Recommended Next Steps</h3>
            <div class="health-tips">
                <div class="tip-item">
                    <span class="tip-icon">üë®‚Äç‚öïÔ∏è</span>
                    <div><strong>Visit a Doctor:</strong> Do not self-medicate. A doctor needs to determine if it is viral or bacterial.</div>
                </div>
                <div class="tip-item">
                    <span class="tip-icon">üíß</span>
                    <div><strong>Stay Hydrated:</strong> Drink plenty of fluids to help loosen mucous in your lungs.</div>
                </div>
                <div class="tip-item">
                    <span class="tip-icon">üõèÔ∏è</span>
                    <div><strong>Rest is Crucial:</strong> Your body needs energy to fight the infection. Avoid strenuous activity.</div>
                </div>
            </div>

            {% else %}
            <h1 class="info-title" style="color: var(--success)">‚úÖ Healthy Lungs</h1>
            <div class="info-text" style="border-color: var(--success);">
                Great news! Our AI did not detect any signs of pneumonia. Your lungs appear clear based on this scan.
            </div>

            <h3 style="margin-top: 30px;">Tips for Healthy Lungs</h3>
            <div class="health-tips">
                <div class="tip-item">
                    <span class="tip-icon">üö≠</span>
                    <div><strong>Don't Smoke:</strong> Smoking damages lung tissue and makes you more vulnerable to infections.</div>
                </div>
                <div class="tip-item">
                    <span class="tip-icon">üèÉ</span>
                    <div><strong>Exercise Regularly:</strong> Cardio activities help strengthen your lungs and improve capacity.</div>
                </div>
                <div class="tip-item">
                    <span class="tip-icon">üßº</span>
                    <div><strong>Good Hygiene:</strong> Wash hands frequently to prevent respiratory infections like the flu.</div>
                </div>
            </div>
            {% endif %}

        </div>
    </div>

    <script>
        function showLoader() {
            document.getElementById('dropZone').style.display = 'none';
            document.getElementById('loader').style.display = 'block';
            document.getElementById('uploadForm').submit();
        }
    </script>
</body>
</html>